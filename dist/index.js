"use strict";$(document).ready(function(){var a=document.querySelectorAll("#menu__item");document.querySelector(".menu").addEventListener("click",function(e){for(var t=0;t<a.length;t++)a[t].classList.remove("menu__item--active")});for(var e=function(n){a[n].addEventListener("click",function(e){if(e.preventDefault(),e.stopPropagation(),a[n].classList.contains("menu__item--active"))a[n].classList.remove("menu__item--active");else{for(var t=0;t<a.length;t++)a[t].classList.remove("menu__item--active");a[n].classList.add("menu__item--active")}})},t=0;t<a.length;t++)e(t);$(function(){$(".scrollarrow").on("click",function(e){e.preventDefault();var t,n,a=$(this),o=a.closest(".slider__container"),i=$(".slider__item",o),r=i.filter(".active");a.hasClass("scrollarrow--right")&&(t=r.next(),n=i.first()),a.hasClass("scrollarrow--left")&&(t=r.prev(),n=i.last()),function(e,t){var n=e.find(".slider__item"),a=n.filter(".active"),o=n.eq(t),i=o.index(),r=e.find(".slider__list");o.length&&r.animate({left:100*-i+"%"},500,function(){a.removeClass("active"),o.addClass("active")})}(o,t.length?t.index():n.index())})});function n(e,t){e.eq(t).addClass("active").siblings().removeClass("active")}function o(e){if(!l){l=!0;var t=function(e){return"".concat(-100*e,"%")}(e);n(r,e),n($(".fixed-menu__item"),e),c.css({transform:"translateY(".concat(t,")")}),setTimeout(function(){l=!1},1300)}}function i(e){var t=r.filter(".active"),n=t.next(),a=t.prev();"next"===e&&n.length&&o(n.index()),"prev"===e&&a.length&&o(a.index())}var r=$(".section"),c=$(".maincontent"),l=!1,s=new MobileDetect(window.navigator.userAgent).mobile();$(document).on({wheel:function(e){var t=e.originalEvent.deltaY;t<0&&i("prev"),0<t&&i("next")},keydown:function(e){var t=e.target.tagName.toLowerCase();if(!("input"===t||"textarea"===t))switch(e.keyCode){case 40:i("next");break;case 38:i("prev")}}}),$("[data-scroll-to]").on("click",function(e){e.preventDefault(),o(parseInt($(e.currentTarget).attr("data-scroll-to")))}),s&&(window.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1}),$("body").swipe({swipe:function(e,t){var n;"up"===t&&(n="next"),"down"===t&&(n="prev"),i(n)}}));var m=document.querySelectorAll(".team__item");document.querySelector(".team__people").addEventListener("click",function(e){e.preventDefault();for(var t=0;t<m.length;t++)m[t].classList.remove("team__item--active")});var u=function(n){m[n].addEventListener("click",function(e){if(e.preventDefault(),e.stopPropagation(),m[n].classList.contains("team__item--active"))m[n].classList.remove("team__item--active");else{for(var t=0;t<m.length;t++)m[t].classList.remove("team__item--active");m[n].classList.add("team__item--active")}})};for(t=0;t<m.length;t++)u(t);var d=document.querySelector("#menulink"),v=document.querySelector("#fullscreen");d.addEventListener("click",function(){fullscreen.style.right="0"}),$(".hamburger__link").on("click",function(e){fullscreen.style.right="-100%"}),document.querySelector("#exit").addEventListener("click",function(e){e.preventDefault(),v.style.right="-100%"});var f=document.querySelector(".reviews"),p=document.querySelector(".overlay"),y=document.querySelector(".overlay__text");f.addEventListener("click",function(e){var t=e.target;if("BUTTON"===t.tagName){var n=t.previousElementSibling.previousElementSibling.innerHTML+t.previousElementSibling.innerHTML;y.innerHTML=n,p.style.display="block",document.body.style.overflow="hidden"}document.addEventListener("keyup",function(e){"Escape"===e.key&&(p.style.display="none",document.body.style.overflow="inherit")}),document.querySelector(".overlay__exit").addEventListener("click",function(e){e.preventDefault(),p.style.display="none",document.body.style.overflow="inherit"})});var g=document.querySelector(".form__elem"),_=document.querySelector(".btn--send");function k(e){return e.nextElementSibling.textContent=e.validationMessage,e.checkValidity()}g.addEventListener("keydown",function(e){if("phone"==e.target.name||"apartment"==e.target.name||"floor"==e.target.name){var t=!1,n=!1;(0<=e.key||e.key<=9)&&(t=!0),"ArrowLeft"!=e.key&&"ArrowRight"!=e.key&&"Backspace"!=e.key||(n=!0),t||n||e.preventDefault()}}),_.addEventListener("click",function(e){if(e.preventDefault(),function(){var e=!0;k(g.elements.name)||(e=!1);k(g.elements.phone)||(e=!1);k(g.elements.comment)||(e=!1);return e}()){g.elements.apartment.value,g.elements.building.value,g.elements.comment.value,g.elements.floor.value,g.elements.home.value,g.elements.name.value,g.elements.phone.value,g.elements.question1.checked,g.elements.question2.checked,g.elements.question3.checked,g.elements.street.value;var t=new FormData(g);t.append("name",g.elements.name.value),t.append("phone",g.elements.phone.value),t.append("comment",g.elements.comment.value),t.append("to","gi.32@gmail.com");var n=new XMLHttpRequest;n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.send(t),n.responseType="json",n.addEventListener("load",function(){if(n.response.status){var t=document.querySelector(".overlay--modal");t.style.display="block",document.body.style.overflow="hidden",document.querySelector(".overlay__text--modal").innerHTML="Заказ отправлен",g.reset(),document.addEventListener("keyup",function(e){"Escape"===e.key&&(t.style.display="none")}),document.querySelector(".overlay__exit--modal").addEventListener("click",function(e){e.preventDefault(),t.style.display="none",document.body.style.overflow="inherit"})}})}}),ymaps.ready(function(){var e=new ymaps.Map("map",{center:[59.93543728,30.32056584],zoom:12,controls:["zoomControl"],behaviors:["drag"]});myGeoObjects=[],myGeoObjects[0]=new ymaps.Placemark([59.97801011,30.3113368],{},{iconLayout:"default#image",iconImageHref:"images/icons/map-marker.svg",iconImageSize:[46,57],iconImageOffset:[-20,-20]}),myGeoObjects[1]=new ymaps.Placemark([59.94513339,30.38312347],{},{iconLayout:"default#image",iconImageHref:"images/icons/map-marker.svg",iconImageSize:[46,57],iconImageOffset:[-20,-20]}),myGeoObjects[2]=new ymaps.Placemark([59.92042544,30.49717524],{},{iconLayout:"default#image",iconImageHref:"images/icons/map-marker.svg",iconImageSize:[46,57],iconImageOffset:[-20,-40]}),myGeoObjects[3]=new ymaps.Placemark([59.88686609,30.31857879],{},{iconLayout:"default#image",iconImageHref:"images/icons/map-marker.svg",iconImageSize:[46,57],iconImageOffset:[-20,-40]});var t=new ymaps.Clusterer({clusterDisableClickZoom:!0});t.add(myGeoObjects),e.geoObjects.add(t)}),video=document.querySelector(".player"),progress=document.querySelector(".bar");var h=!1;$("#play-pause").add(".player").click(function(){h?(h=!1,$("#play-pause").removeClass("pause"),video.pause()):(h=!0,$("#play-pause").addClass("pause"),video.play())}),$("#volume").on("change",function(){$(".player").prop("volume",this.value)}),$(".sound__img").click(function(e){video.muted?$(".player").prop("muted",!1):$(".player").prop("muted",!0)}),video.ontimeupdate=function(){var e=video.duration,t=video.currentTime;progress.value=100*t/e},progress.onclick=function(){var e=this.offsetWidth,t=event.offsetX;this.value=100*t/e,video.pause(),video.currentTime=video.duration*(t/e),video.play()}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsInJlYWR5IiwicXVlcnlTZWxlY3RvciIsIm1lbnUiLCJpIiwibWVudV9faXRlbSIsImxlbmd0aCIsIl9sb29wIiwiZSIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwicmVtb3ZlIiwiYWRkIiwicmVxSXRlbSIsInByZXZlbnREZWZhdWx0IiwiJHRoaXMiLCJ0aGlzIiwiY29udGFpbmVyIiwiY2xvc2VzdCIsIml0ZW1zIiwiaGFzQ2xhc3MiLCJleGlzdGVkSXRlbSIsImFjdGl2ZUl0ZW0iLCJuZXh0IiwiZWRnZUl0ZW0iLCJmaXJzdCIsInByZXYiLCJsYXN0Iiwic2xpZGVOdW0iLCJmaW5kIiwiYWN0aXZlU2xpZGUiLCJmaWx0ZXIiLCJlcSIsImxpc3QiLCJhbmltYXRlIiwibGVmdCIsInJlcUluZGV4IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImluZGV4Iiwic3dpdGNoQWN0aXZlQ2xhc3MiLCJlbGVtcyIsImVsZW1OZHgiLCJzaWJsaW5ncyIsInBlcmZvcm1UcmFuc2l0aW9uIiwic2VjdGlvbkVxIiwiaW5zY3JvbGwiLCJwb3NpdGlvbiIsImNvbmNhdCIsImNvdW50UG9zaXRpb25QZXJjZW50Iiwic2VjdGlvbnMiLCJkaXNwbGF5IiwiY3NzIiwic2V0VGltZW91dCIsInNjcm9sbFZpZXdwb3J0IiwiZGlyZWN0aW9uIiwiYWN0aXZlU2VjdGlvbiIsIm5leHRTZWN0aW9uIiwicHJldlNlY3Rpb24iLCJpc01vYmlsZSIsIm1vdmVTbGlkZSIsIm1vYmlsZSIsIndoZWVsIiwiZGVsdGFZIiwib3JpZ2luYWxFdmVudCIsImtleWRvd24iLCJ0YWdOYW1lIiwidGFyZ2V0IiwidG9Mb3dlckNhc2UiLCJvbiIsIndpbmRvdyIsInN3aXBlIiwicGFzc2l2ZSIsImV2ZW50Iiwic2Nyb2xsRGlyZWNyaW9uIiwidGVhbSIsInRlYW1fX2l0ZW0iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2xvb3AyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN0b3BQcm9wYWdhdGlvbiIsImZ1bGxzY3JlZW4iLCJoZWFkZXJfX21lbnVfX2xpbmsiLCJoYW1idXJnZXJfX2Z1bGxzY3JlZW4iLCJyZXZpZXdzIiwic3R5bGUiLCJyaWdodCIsIm92ZXJsYXkiLCJvdmVybGF5RXhpdCIsImJvZHkiLCJvdmVyZmxvdyIsImtleSIsImlzQ29udHJvbCIsInNlbmRCdXR0b24iLCJpY29uSW1hZ2VTaXplIiwibXlHZW9PYmplY3RzIiwiZmllbGQiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJ0ZXh0Q29udGVudCIsInZhbGlkYXRpb25NZXNzYWdlIiwiYXBhcnRtZW50IiwiYnVpbGRpbmciLCJjb21tZW50IiwiaG9tZSIsInBob25lIiwicXVlc3Rpb24xIiwicXVlc3Rpb24zIiwic3RyZWV0IiwiaXNEaWdpdCIsImZvcm1EYXRhIiwieGhyIiwidmFsaWQiLCJjZW50ZXIiLCJ6b29tIiwidmFsaWRhdGVGaWVsZCIsIm15Rm9ybSIsImVsZW1lbnRzIiwiaWNvbkltYWdlSHJlZiIsInZhbGlkYXRlRm9ybSIsIm92ZXJsYXlGb3JtIiwidmFsdWUiLCJmbG9vciIsInBvcHVwVGV4dCIsInF1ZXN0aW9uMiIsImNoZWNrZWQiLCJGb3JtRGF0YSIsImFwcGVuZCIsIm5hbWUiLCJvcGVuIiwic2VuZCIsInJlc3BvbnNlVHlwZSIsInJlc3BvbnNlIiwic3RhdHVzIiwiaW5uZXJIVE1MIiwicmVzZXQiLCJpY29uSW1hZ2VPZmZzZXQiLCJpY29uTGF5b3V0IiwiYmVoYXZpb3JzIiwiY2x1c3RlckRpc2FibGVDbGlja1pvb20iLCJ5bWFwcyIsIlBsYWNlbWFyayIsImNsdXN0ZXJlciIsIm15TWFwIiwidmlkZW8iLCJwcm9ncmVzcyIsImlzU3RhcnRlZCIsImNsaWNrIiwicGxheSIsInByb3AiLCJtdXRlZCIsIm9udGltZXVwZGF0ZSIsImQiLCJkdXJhdGlvbiIsImMiLCJjdXJyZW50VGltZSIsIm9uY2xpY2siLCJ3Iiwib2Zmc2V0V2lkdGgiLCJvIiwib2Zmc2V0WCIs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QU9BLFdBQ0EsSUFBQUMsRUFBQTVJLEtBQUE2SSxZQUNBQyxFQUFBckYsTUFBQXNGLFFBQ0EvSSxLQUFBd0csTUFBQSxJQUFBc0MsRUFBQUYsRUFDQWIsTUFBQWlCLFFBQ0FqQixNQUFBVyxZQUFBWCxNQUFBUyxVQUFBTSxFQUFBRixHQUNBYixNQUFBSSIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCl7XHJcblxyXG5sZXQgbWVudV9faXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjbWVudV9faXRlbVwiKTtcclxubGV0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1lbnVcIik7XHJcblxyXG5tZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgbWVudV9faXRlbS5sZW5ndGg7IGkrKykge1xyXG4gICAgbWVudV9faXRlbSBbaV0uY2xhc3NMaXN0LnJlbW92ZShcIm1lbnVfX2l0ZW0tLWFjdGl2ZVwiKTtcclxufVxyXG59KVxyXG5cclxuZm9yIChsZXQgaSA9IDA7IGkgPCBtZW51X19pdGVtLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBtZW51X19pdGVtW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgaWYgKG1lbnVfX2l0ZW1baV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdtZW51X19pdGVtLS1hY3RpdmUnKSkge1xyXG4gICAgICAgICAgICBtZW51X19pdGVtW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJtZW51X19pdGVtLS1hY3RpdmVcIilcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWVudV9faXRlbS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBtZW51X19pdGVtW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ21lbnVfX2l0ZW0tLWFjdGl2ZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG1lbnVfX2l0ZW1baV0uY2xhc3NMaXN0LmFkZCgnbWVudV9faXRlbS0tYWN0aXZlJylcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59O1xyXG5cclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG52YXIgbW92ZVNsaWRlID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgc2xpZGVOdW0pIHtcclxuICAgIHZhciBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnNsaWRlcl9faXRlbVwiKSxcclxuICAgICAgICBhY3RpdmVTbGlkZSA9IGl0ZW1zLmZpbHRlcihcIi5hY3RpdmVcIiksXHJcbiAgICAgICAgcmVxSXRlbSA9IGl0ZW1zLmVxKHNsaWRlTnVtKSxcclxuICAgICAgICByZXFJbmRleCA9IHJlcUl0ZW0uaW5kZXgoKSxcclxuICAgICAgICBsaXN0ID0gY29udGFpbmVyLmZpbmQoXCIuc2xpZGVyX19saXN0XCIpLFxyXG4gICAgICAgIGR1cmF0aW9uID0gNTAwOyAgICAgXHJcblxyXG4gICAgaWYgKHJlcUl0ZW0ubGVuZ3RoKXsgICAgXHJcbiAgICAgIGxpc3QuYW5pbWF0ZSh7XCJsZWZ0XCI6IC1yZXFJbmRleCAqIDEwMCArIFwiJVwifSwgZHVyYXRpb24sIGZ1bmN0aW9uICgpIHtcclxuICAgIGFjdGl2ZVNsaWRlLnJlbW92ZUNsYXNzIChcImFjdGl2ZVwiKTtcclxuICAgIHJlcUl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG4gIH0pO1xyXG59XHJcbiAgfVxyXG5cclxuXHJcbiQoXCIuc2Nyb2xsYXJyb3dcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHZhciAkdGhpcyA9ICQodGhpcyksXHJcbiAgY29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi5zbGlkZXJfX2NvbnRhaW5lclwiKSxcclxuICBpdGVtcyA9ICQoXCIuc2xpZGVyX19pdGVtXCIsIGNvbnRhaW5lciksXHJcbiAgYWN0aXZlSXRlbSA9IGl0ZW1zLmZpbHRlcihcIi5hY3RpdmVcIiksICBcclxuICBleGlzdGVkSXRlbSwgZWRnZUl0ZW0sIHJlcUl0ZW07XHJcblxyXG4gIGlmICgkdGhpcy5oYXNDbGFzcyhcInNjcm9sbGFycm93LS1yaWdodFwiKSl7IC8vbmV4dFxyXG5leGlzdGVkSXRlbSA9IGFjdGl2ZUl0ZW0ubmV4dCgpO1xyXG5lZGdlSXRlbSA9IGl0ZW1zLmZpcnN0KCk7XHJcbiAgfVxyXG4gIGlmICgkdGhpcy5oYXNDbGFzcyhcInNjcm9sbGFycm93LS1sZWZ0XCIpKXtcclxuICAgIGV4aXN0ZWRJdGVtID0gYWN0aXZlSXRlbS5wcmV2KCk7XHJcbiAgICBlZGdlSXRlbSA9IGl0ZW1zLmxhc3QoKTtcclxuICB9XHJcbiAgcmVxSXRlbSA9IGV4aXN0ZWRJdGVtLmxlbmd0aCA/IGV4aXN0ZWRJdGVtLmluZGV4KCkgOiBlZGdlSXRlbS5pbmRleCgpO1xyXG4gbW92ZVNsaWRlKGNvbnRhaW5lciwgcmVxSXRlbSk7XHJcbiAgXHJcbn0pXHJcbn0pXHJcbi8vINCh0LrRgNC+0LvQu1xyXG5cclxuY29uc3Qgc2VjdGlvbnMgPSAkKFwiLnNlY3Rpb25cIik7XHJcbmNvbnN0IGRpc3BsYXkgPSAkKFwiLm1haW5jb250ZW50XCIpO1xyXG5sZXQgaW5zY3JvbGwgPSBmYWxzZTtcclxuXHJcbmNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG5jb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcclxuXHJcbmNvbnN0IGNvdW50UG9zaXRpb25QZXJjZW50ID0gc2VjdGlvbkVxID0+IHtcclxuICByZXR1cm4gYCR7c2VjdGlvbkVxICogLTEwMH0lYDtcclxufTtcclxuXHJcbmNvbnN0IHN3aXRjaEFjdGl2ZUNsYXNzID0gKGVsZW1zLCBlbGVtTmR4KSA9PiB7XHJcbiAgZWxlbXNcclxuICAgIC5lcShlbGVtTmR4KVxyXG4gICAgLmFkZENsYXNzKFwiYWN0aXZlXCIpXHJcbiAgICAuc2libGluZ3MoKVxyXG4gICAgLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG59O1xyXG5cclxuY29uc3QgdW5CbG9ja1Njcm9sbCA9ICgpID0+IHtcclxuICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgIGluc2Nyb2xsID0gZmFsc2U7XHJcbiAgfSwgMTMwMCk7IC8vINC/0L7QtNC+0LbQtNCw0YLRjCDQv9C+0LrQsCDQt9Cw0LLQtdGA0YjQuNGC0YHRjyDQuNC90LXRgNGG0LjRjyDQvdCwINGC0LDRh9C/0LDQtNCw0YVcclxufTtcclxuXHJcbmNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gc2VjdGlvbkVxID0+IHtcclxuICBpZiAoaW5zY3JvbGwpIHJldHVybjtcclxuICBpbnNjcm9sbCA9IHRydWU7XHJcblxyXG4gIGNvbnN0IHBvc2l0aW9uID0gY291bnRQb3NpdGlvblBlcmNlbnQoc2VjdGlvbkVxKTtcclxuICBjb25zdCBzd2l0Y2hGaXhlZE1lbnVDbGFzcyA9ICgpID0+XHJcbiAgICBzd2l0Y2hBY3RpdmVDbGFzcygkKFwiLmZpeGVkLW1lbnVfX2l0ZW1cIiksIHNlY3Rpb25FcSk7XHJcblxyXG4gIHN3aXRjaEFjdGl2ZUNsYXNzKHNlY3Rpb25zLCBzZWN0aW9uRXEpO1xyXG4gIHN3aXRjaEZpeGVkTWVudUNsYXNzKCk7XHJcblxyXG4gIGRpc3BsYXkuY3NzKHtcclxuICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoJHtwb3NpdGlvbn0pYFxyXG4gIH0pO1xyXG5cclxuIFxyXG5cclxuICB1bkJsb2NrU2Nyb2xsKCk7XHJcbn07XHJcblxyXG5jb25zdCBzY3JvbGxWaWV3cG9ydCA9IGRpcmVjdGlvbiA9PiB7XHJcbiAgY29uc3QgYWN0aXZlU2VjdGlvbiA9IHNlY3Rpb25zLmZpbHRlcihcIi5hY3RpdmVcIik7XHJcbiAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcclxuICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xyXG5cclxuXHJcbiAgaWYgKGRpcmVjdGlvbiA9PT0gXCJuZXh0XCIgJiYgbmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcclxuICB9XHJcblxyXG4gIGlmIChkaXJlY3Rpb24gPT09IFwicHJldlwiICYmIHByZXZTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgcGVyZm9ybVRyYW5zaXRpb24ocHJldlNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgfVxyXG59O1xyXG5cclxuJChkb2N1bWVudCkub24oe1xyXG4gICAgd2hlZWw6IGUgPT4ge1xyXG4gICAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gIFxyXG4gICAgICBpZiAoZGVsdGFZIDwgMCkge1xyXG4gICAgICAgICAgc2Nyb2xsVmlld3BvcnQoXCJwcmV2XCIpXHJcbiAgICAgIH1cclxuICAgICAgaWYgKGRlbHRhWSA+IDApIHtcclxuICAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwibmV4dFwiKVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgfSxcclxuICAgIGtleWRvd246IGUgPT4ge1xyXG4gICAgICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICBjb25zdCB1c2VyVHlwaW5nSW5JbnB1dHMgPSB0YWdOYW1lID09PSBcImlucHV0XCIgfHwgdGFnTmFtZSA9PT0gXCJ0ZXh0YXJlYVwiO1xyXG4gIFxyXG4gICAgICBpZiAodXNlclR5cGluZ0luSW5wdXRzKSByZXR1cm47XHJcbiAgXHJcbiAgICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XHJcbiAgICAgICAgY2FzZSA0MDpcclxuICAgICAgICAgIHNjcm9sbFZpZXdwb3J0KFwibmV4dFwiKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gIFxyXG4gICAgICAgIGNhc2UgMzg6XHJcbiAgICAgICAgICBzY3JvbGxWaWV3cG9ydChcInByZXZcIik7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuXHJcblxyXG4kKFwiW2RhdGEtc2Nyb2xsLXRvXVwiKS5vbihcImNsaWNrXCIsIGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBwZXJmb3JtVHJhbnNpdGlvbihwYXJzZUludCgkKGUuY3VycmVudFRhcmdldCkuYXR0cihcImRhdGEtc2Nyb2xsLXRvXCIpKSk7XHJcbn0pO1xyXG5cclxuLy8g0YDQsNC30YDQtdGI0LDQtdC8INGB0LLQsNC50L8g0L3QsCDQvNC+0LHQuNC70YzQvdC40LrQsNGFXHJcbmlmIChpc01vYmlsZSkge1xyXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgXCJ0b3VjaG1vdmVcIixcclxuICAgIGUgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9LFxyXG4gICAgeyBwYXNzaXZlOiBmYWxzZSB9XHJcbiAgKTtcclxuXHJcbiAgJChcImJvZHlcIikuc3dpcGUoe1xyXG4gICAgc3dpcGU6IChldmVudCwgZGlyZWN0aW9uKSA9PiB7XHJcbiAgICAgIGxldCBzY3JvbGxEaXJlY3Jpb247XHJcbiAgICAgIGlmIChkaXJlY3Rpb24gPT09IFwidXBcIikgc2Nyb2xsRGlyZWNyaW9uID0gXCJuZXh0XCI7XHJcbiAgICAgIGlmIChkaXJlY3Rpb24gPT09IFwiZG93blwiKSBzY3JvbGxEaXJlY3Jpb24gPSBcInByZXZcIjtcclxuICAgICAgc2Nyb2xsVmlld3BvcnQoc2Nyb2xsRGlyZWNyaW9uKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxubGV0IHRlYW1fX2l0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnRlYW1fX2l0ZW1cIik7XHJcbmxldCB0ZWFtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50ZWFtX19wZW9wbGVcIik7XHJcblxyXG5cclxudGVhbS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZWFtX19pdGVtLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGVhbV9faXRlbVtpXS5jbGFzc0xpc3QucmVtb3ZlKFwidGVhbV9faXRlbS0tYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gICAgfSlcclxuICAgIFxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0ZWFtX19pdGVtLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGVhbV9faXRlbVtpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGVhbV9faXRlbVtpXS5jbGFzc0xpc3QuY29udGFpbnMoJ3RlYW1fX2l0ZW0tLWFjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgICAgICB0ZWFtX19pdGVtW2ldLmNsYXNzTGlzdC5yZW1vdmUoXCJ0ZWFtX19pdGVtLS1hY3RpdmVcIikgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRlYW1fX2l0ZW0ubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgdGVhbV9faXRlbVtpXS5jbGFzc0xpc3QucmVtb3ZlKCd0ZWFtX19pdGVtLS1hY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRlYW1fX2l0ZW1baV0uY2xhc3NMaXN0LmFkZCgndGVhbV9faXRlbS0tYWN0aXZlJykgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuXHJcbmxldCBoZWFkZXJfX21lbnVfX2xpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21lbnVsaW5rXCIpO1xyXG5sZXQgaGFtYnVyZ2VyX19mdWxsc2NyZWVuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNmdWxsc2NyZWVuXCIpO1xyXG5oZWFkZXJfX21lbnVfX2xpbmsuYWRkRXZlbnRMaXN0ZW5lciAoXCJjbGlja1wiLCBmdW5jdGlvbigpe1xyXG4gICAgZnVsbHNjcmVlbi5zdHlsZS5yaWdodCA9ICcwJyB9XHJcbilcclxuJChcIi5oYW1idXJnZXJfX2xpbmtcIikub24oXCJjbGlja1wiLCBlID0+e1xyXG4gIGZ1bGxzY3JlZW4uc3R5bGUucmlnaHQgPSAnLTEwMCUnXHJcbn0pXHJcblxyXG5sZXQgZXhpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZXhpdFwiKTtcclxuXHJcbmV4aXQuYWRkRXZlbnRMaXN0ZW5lciAoXCJjbGlja1wiLCBmdW5jdGlvbihlKXsgICAgXHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBoYW1idXJnZXJfX2Z1bGxzY3JlZW4uc3R5bGUucmlnaHQgPSBcIi0xMDAlXCI7XHJcbn0gKVxyXG5cclxuY29uc3QgcmV2aWV3cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmV2aWV3c1wiKTtcclxuY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKTtcclxuY29uc3QgcG9wdXBUZXh0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5vdmVybGF5X190ZXh0XCIpO1xyXG5cclxuXHJcbnJldmlld3MuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGU9PiB7XHJcbiAgICBsZXQgZWxlbSA9IGUudGFyZ2V0O1xyXG4gICAgaWYgKGVsZW0udGFnTmFtZSA9PT0gXCJCVVRUT05cIikgeyAgICAgICAgXHJcbiAgICAgICAgdmFyIG1vZGFsVGV4dCA9IGVsZW0ucHJldmlvdXNFbGVtZW50U2libGluZy5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLmlubmVySFRNTCArIGVsZW0ucHJldmlvdXNFbGVtZW50U2libGluZy5pbm5lckhUTUw7ICAgICAgICAgXHJcbiAgICAgICAgcG9wdXBUZXh0LmlubmVySFRNTCA9IG1vZGFsVGV4dDsgICAgICAgIFxyXG4gICAgICAgIG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7ICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBlID0+IHtcclxuICAgICAgICBsZXQga2V5TmFtZSA9IGUua2V5O1xyXG5cclxuICAgICAgICBpZihrZXlOYW1lID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaW5oZXJpdCc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfSlcclxuICAgIGxldCBvdmVybGF5RXhpdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheV9fZXhpdFwiKTtcclxuICAgIG92ZXJsYXlFeGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcclxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJ2luaGVyaXQnO1xyXG4gICAgfSlcclxufSk7XHJcblxyXG5cclxuXHJcbmNvbnN0IG15Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fZWxlbVwiKVxyXG5jb25zdCBzZW5kQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5idG4tLXNlbmRcIilcclxuXHJcbiAgICBcclxuICAgIG15Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBlID0+IHsgICAgXHJcbiAgICBpZiAoZS50YXJnZXQubmFtZSA9PSAncGhvbmUnICB8fCBlLnRhcmdldC5uYW1lID09ICdhcGFydG1lbnQnIHx8IGUudGFyZ2V0Lm5hbWUgPT0gJ2Zsb29yJyApIHtcclxuICAgIGxldCBpc0RpZ2l0ID0gZmFsc2U7XHJcbiAgICBsZXQgaXNEYXNoID0gZmFsc2U7XHJcbiAgICBsZXQgaXNDb250cm9sID0gZmFsc2U7XHJcblxyXG4gICAgaWYgKGUua2V5ID49IDAgfHwgZS5rZXkgPD0gOSkge1xyXG4gICAgICAgIGlzRGlnaXQgPSB0cnVlXHJcbiAgICB9XHJcbiAgICBpZiAoZS5rZXkgPT0gXCJBcnJvd0xlZnRcIiB8fCBlLmtleSA9PSBcIkFycm93UmlnaHRcIiB8fCBlLmtleSA9PSBcIkJhY2tzcGFjZVwiKSB7XHJcbiAgICAgICAgaXNDb250cm9sID0gdHJ1ZVxyXG4gICAgfVxyXG4gICAgaWYgKCFpc0RpZ2l0ICYmICFpc0NvbnRyb2wpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9XHJcbiAgICB9XHJcbn0pXHJcblxyXG5cclxuXHJcbnNlbmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lciAoXCJjbGlja1wiLCBlID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmICh2YWxpZGF0ZUZvcm0obXlGb3JtKSkgeyAgICAgXHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICAgICAgYXBhcnRtZW50OiBteUZvcm0uZWxlbWVudHMuYXBhcnRtZW50LnZhbHVlLFxyXG4gICAgICAgICAgICBidWlsZGluZzogbXlGb3JtLmVsZW1lbnRzLmJ1aWxkaW5nLnZhbHVlLFxyXG4gICAgICAgICAgICBjb21tZW50OiBteUZvcm0uZWxlbWVudHMuY29tbWVudC52YWx1ZSxcclxuICAgICAgICAgICAgZmxvb3I6IG15Rm9ybS5lbGVtZW50cy5mbG9vci52YWx1ZSxcclxuICAgICAgICAgICAgaG9tZTogbXlGb3JtLmVsZW1lbnRzLmhvbWUudmFsdWUsXHJcbiAgICAgICAgICAgIG5hbWU6IG15Rm9ybS5lbGVtZW50cy5uYW1lLnZhbHVlLFxyXG4gICAgICAgICAgICBwaG9uZTogbXlGb3JtLmVsZW1lbnRzLnBob25lLnZhbHVlLFxyXG4gICAgICAgICAgICBxdWVzdGlvbjE6IG15Rm9ybS5lbGVtZW50cy5xdWVzdGlvbjEuY2hlY2tlZCxcclxuICAgICAgICAgICAgcXVlc3Rpb24yOiBteUZvcm0uZWxlbWVudHMucXVlc3Rpb24yLmNoZWNrZWQsXHJcbiAgICAgICAgICAgIHF1ZXN0aW9uMzogbXlGb3JtLmVsZW1lbnRzLnF1ZXN0aW9uMy5jaGVja2VkLFxyXG4gICAgICAgICAgICBzdHJlZXQ6IG15Rm9ybS5lbGVtZW50cy5zdHJlZXQudmFsdWVcclxuICAgICAgICB9XHJcbiAgICAgICBcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKG15Rm9ybSk7XHJcbiAgICBmb3JtRGF0YS5hcHBlbmQoXCJuYW1lXCIsIG15Rm9ybS5lbGVtZW50cy5uYW1lLnZhbHVlKTtcclxuICAgIGZvcm1EYXRhLmFwcGVuZChcInBob25lXCIsIG15Rm9ybS5lbGVtZW50cy5waG9uZS52YWx1ZSk7XHJcbiAgICBmb3JtRGF0YS5hcHBlbmQoXCJjb21tZW50XCIsIG15Rm9ybS5lbGVtZW50cy5jb21tZW50LnZhbHVlKTtcclxuICAgIGZvcm1EYXRhLmFwcGVuZChcInRvXCIsIFwiZ2kuMzJAZ21haWwuY29tXCIpOyBcclxuICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgIHhoci5vcGVuKCdQT1NUJywgJ2h0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbCcpO1xyXG4gICAgeGhyLnNlbmQoZm9ybURhdGEpOyBcclxuICAgIHhoci5yZXNwb25zZVR5cGUgPSBcImpzb25cIjtcclxuICAgIHhoci5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgIFxyXG4gICAgICAgIGlmICh4aHIucmVzcG9uc2Uuc3RhdHVzKSB7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxldCBvdmVybGF5Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheS0tbW9kYWxcIik7XHJcbiAgICAgICAgICAgIG92ZXJsYXlGb3JtLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuICAgICAgICAgICAgbGV0IHBvcHVwVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheV9fdGV4dC0tbW9kYWxcIilcclxuICAgICAgICAgICAgcG9wdXBUZXh0LmlubmVySFRNTCA9IFwi0JfQsNC60LDQtyDQvtGC0L/RgNCw0LLQu9C10L1cIjsgICAgXHJcbiAgICAgICAgICAgIG15Rm9ybS5yZXNldCgpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgZSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBrZXlOYW1lID0gZS5rZXk7ICAgICAgICBcclxuICAgICAgICAgICAgaWYoa2V5TmFtZSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICBvdmVybGF5Rm9ybS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCJcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgfSlcclxuICAgICAgICBsZXQgb3ZlcmxheUV4aXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlfX2V4aXQtLW1vZGFsXCIpO1xyXG4gICAgICAgIG92ZXJsYXlFeGl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgb3ZlcmxheUZvcm0uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiXHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdpbmhlcml0JztcclxuICAgICAgICB9KVxyXG4gICAgfSBcclxuICAgIH0pXHJcbiAgICB9XHJcbn0pO1xyXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVGb3JtKGZvcm0pIHtcclxuICAgICAgICBsZXQgdmFsaWQgPSB0cnVlO1xyXG4gICAgXHJcbiAgICAgICAgaWYoIXZhbGlkYXRlRmllbGQobXlGb3JtLmVsZW1lbnRzLm5hbWUpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgaWYoIXZhbGlkYXRlRmllbGQobXlGb3JtLmVsZW1lbnRzLnBob25lKSkge1xyXG4gICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIGlmKCF2YWxpZGF0ZUZpZWxkKG15Rm9ybS5lbGVtZW50cy5jb21tZW50KSkge1xyXG4gICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgIHJldHVybiB2YWxpZDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVGaWVsZChmaWVsZCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBmaWVsZC5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBmaWVsZC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgICAgICAgICAgcmV0dXJuIGZpZWxkLmNoZWNrVmFsaWRpdHkoKTsgXHJcbiAgICAgICAgfVxyXG5cclxuICBcclxuICAgIHltYXBzLnJlYWR5KGluaXQpO1xyXG4gICAgXHJcbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpeyBcclxuICAgICAgICAgICAgdmFyIG15TWFwID0gbmV3IHltYXBzLk1hcChcIm1hcFwiLCB7XHJcbiAgICAgICAgICAgICAgICBjZW50ZXI6IFs1OS45MzU0MzcyOCwgMzAuMzIwNTY1ODRdLFxyXG4gICAgICAgICAgICAgICAgem9vbTogMTIsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sczogWyd6b29tQ29udHJvbCddLFxyXG4gICAgICAgICAgICAgICAgYmVoYXZpb3JzOiBbJ2RyYWcnXVxyXG4gICAgICAgICAgICB9KTsgXHJcbiAgICAgICAgICAgIG15R2VvT2JqZWN0cyA9IFtdO1xyXG4gICAgICAgICAgICBteUdlb09iamVjdHNbMF0gPSBuZXcgeW1hcHMuUGxhY2VtYXJrIChbNTkuOTc4MDEwMTEsIDMwLjMxMTMzNjgwXSwge30sIHtcclxuICAgICAgICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlSHJlZjogJ2ltYWdlcy9pY29ucy9tYXAtbWFya2VyLnN2ZycsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTIwLCAtMjBdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBteUdlb09iamVjdHNbMV0gPSBuZXcgeW1hcHMuUGxhY2VtYXJrIChbNTkuOTQ1MTMzMzksIDMwLjM4MzEyMzQ3XSwge30sIHtcclxuICAgICAgICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlSHJlZjogJ2ltYWdlcy9pY29ucy9tYXAtbWFya2VyLnN2ZycsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTIwLCAtMjBdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBteUdlb09iamVjdHNbMl0gPSBuZXcgeW1hcHMuUGxhY2VtYXJrIChbNTkuOTIwNDI1NDQsIDMwLjQ5NzE3NTI0XSwge30sIHtcclxuICAgICAgICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlSHJlZjogJ2ltYWdlcy9pY29ucy9tYXAtbWFya2VyLnN2ZycsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTIwLCAtNDBdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBteUdlb09iamVjdHNbM10gPSBuZXcgeW1hcHMuUGxhY2VtYXJrIChbNTkuODg2ODY2MDksIDMwLjMxODU3ODc5XSwge30sIHtcclxuICAgICAgICAgICAgICBpY29uTGF5b3V0OiAnZGVmYXVsdCNpbWFnZScsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlSHJlZjogJ2ltYWdlcy9pY29ucy9tYXAtbWFya2VyLnN2ZycsXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlU2l6ZTogWzQ2LCA1N10sXHJcbiAgICAgICAgICAgICAgaWNvbkltYWdlT2Zmc2V0OiBbLTIwLCAtNDBdXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIGNsdXN0ZXJlciA9IG5ldyB5bWFwcy5DbHVzdGVyZXIoe2NsdXN0ZXJEaXNhYmxlQ2xpY2tab29tOiB0cnVlfSlcclxuICAgICAgICAgICAgY2x1c3RlcmVyLmFkZChteUdlb09iamVjdHMpO1xyXG4gICAgICAgICAgICBteU1hcC5nZW9PYmplY3RzLmFkZChjbHVzdGVyZXIpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICB2aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyXCIpXHJcbiAgICAgIHByb2dyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5iYXJcIilcclxuXHJcbiAgICAgIHZhciBpc1N0YXJ0ZWQgPSBmYWxzZTsgXHJcbiAgICAgICQoJyNwbGF5LXBhdXNlJykuYWRkKCcucGxheWVyJykuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICBpZighaXNTdGFydGVkKXsgXHJcbiAgICAgICAgICAgICAgaXNTdGFydGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAkKCcjcGxheS1wYXVzZScpLmFkZENsYXNzICgncGF1c2UnKVxyXG4gICAgICAgICAgICAgIHZpZGVvLnBsYXkoKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaXNTdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgJCgnI3BsYXktcGF1c2UnKS5yZW1vdmVDbGFzcyAoJ3BhdXNlJylcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgfVxyXG4gICAgICB9KSAgICAgIFxyXG5cclxuICAgICAgJCgnI3ZvbHVtZScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKCcucGxheWVyJykucHJvcChcInZvbHVtZVwiLCB0aGlzLnZhbHVlKTtcclxuICAgIH0pO1xyXG4gICAgIFxyXG4gICAgICBcclxuICAgICAgJCgnLnNvdW5kX19pbWcnKS5jbGljayAoIGUgPT4ge1xyXG4gICAgICAgIGlmKHZpZGVvLm11dGVkKXtcclxuICAgICAgICAgICQoJy5wbGF5ZXInKS5wcm9wKCdtdXRlZCcsIGZhbHNlKTsgICAgICAgICAgXHJcbiAgICAgIH1cclxuICAgICAgZWxzZXtcclxuICAgICAgICAgICQoJy5wbGF5ZXInKS5wcm9wKCdtdXRlZCcsdHJ1ZSk7ICAgICAgICAgIFxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgXHJcblxyXG4gICAgdmlkZW8ub250aW1ldXBkYXRlID0gcHJvZ3Jlc3NVcGRhdGU7XHJcbiAgICBwcm9ncmVzcy5vbmNsaWNrID0gdmlkZW9SZXdpbmQ7XHJcblxyXG4gICAgZnVuY3Rpb24gcHJvZ3Jlc3NVcGRhdGUoKSB7XHJcbiAgICAgIGxldCBkID0gdmlkZW8uZHVyYXRpb247XHJcbiAgICAgIGxldCBjID0gdmlkZW8uY3VycmVudFRpbWU7XHJcbiAgICAgIHByb2dyZXNzLnZhbHVlID0gMTAwICogYy9kO1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdmlkZW9SZXdpbmQoKSB7XHJcbiAgICAgIGxldCB3ID0gdGhpcy5vZmZzZXRXaWR0aDtcclxuICAgICAgbGV0IG8gPSBldmVudC5vZmZzZXRYO1xyXG4gICAgICB0aGlzLnZhbHVlID0gMTAwICogby93O1xyXG4gICAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgICB2aWRlby5jdXJyZW50VGltZSA9IHZpZGVvLmR1cmF0aW9uKiAoby93KTtcclxuICAgICAgdmlkZW8ucGxheSgpO1xyXG4gICAgfVxyXG4gIH0pXHJcbiJdfQ==
